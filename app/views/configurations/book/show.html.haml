= stylesheet_link_tag "book_config", media: "all"

:javascript
  window.ODSA = window.ODSA || {};
  window.ODSA.languages = #{@languages.to_json.html_safe};
  window.ODSA.codeLanguages = #{@code_languages.to_json.html_safe};
  window.ODSA.learningTools = #{@learning_tools.to_json.html_safe};
  window.ODSA.availableModules = #{@availMods.to_json.html_safe};

= javascript_include_tag "split.min.js"
= javascript_include_tag "book_config"

%div{id: "add-chapter-dialog", title: "Add Chapter"}
  %p.dialog-errors
  %form
    %fieldset
      %label{for: "chapter-name"}
        Name:
      %input.text.ui-widget-content.ui-corner-all{type: "text", name: "chapter-name", id: "chapter-name"}
      -# Allow form submission using enter key
      %input{id: "add-chapter-submit", type: "submit", tabindex: "-1", style: "position:absolute; top: -1000px;"}

%div{id: "rename-chapter-dialog", title: "Rename Chapter"}
  %p.dialog-errors
  %form
    %fieldset
      %label{for: "chapter-newname"}
        Name:
      %input.text.ui-widget-content.ui-corner-all{type: "text", name: "chapter-newname", id: "chapter-newname"}
      -# Allow form submission using enter key
      %input{id: "rename-chapter-submit", type: "submit", tabindex: "-1", style: "position:absolute; top: -1000px;"}

%div{id: "exercise-settings-dialog", title: "Exercise Settings"}
  %p.dialog-errors
  %form.form-horizontal
    %fieldset.col-xs-12
      .form-group{id: 'exercise-settings-required-group'}
        %label.dialog-control-label.col-xs-4{for: "exercise-settings-required"}
          Required:
        .col-xs-6
          %input{type: "checkbox", id: "exercise-settings-required", checked: "checked"}
      .form-group
        %label.dialog-control-label.col-xs-4{for: "exercise-settings-points"}
          Points:
        .col-xs-6
          %input{type: "number", min: 0, value: 1, id: "exercise-settings-points"}
      .form-group{id: 'exercise-settings-threshold-group'}
        %label.dialog-control-label.col-xs-4{for: "exercise-settings-threshold"}
          Threshold:
        .col-xs-6
          %input{type: "number", min: 1, value: 5, id: "exercise-settings-threshold"}
      %div{id: 'exercise-settings-pe', style: 'display: none'}
        .form-group
          %label.dialog-control-label.col-xs-4{for: "exercise-settings-feedback"}
            Feedback Mode:
          .col-xs-6
            %select{id: "exercise-settings-feedback"}
              %option{value: 'atend'}
                atend
              %option{value: 'continuous'}
                continuous
        .form-group
          %label.dialog-control-label.col-xs-4{for: "exercise-settings-fix"}
            Fix Mode:
          .col-xs-6
            %select{id: "exercise-settings-fix", disabled: true}
              %option{value: 'undo'}
                undo
              %option{value: 'fix'}
                fix
        .form-group
          %label.dialog-control-label.col-xs-4{for: "exercise-settings-code"}
            Hide Code:
          .col-xs-6
            %input{type: "checkbox", id: "exercise-settings-code"}
      -# Allow form submission using enter key
      %input{id: "exercise-settings-submit", type: "submit", tabindex: "-1", style: "position:absolute; top: -1000px;"}


.container
  %h2
    Book Settings
  %form.form-horizontal{method: "post", id: 'book-config-form'}
    
    .form-group
      %label.control-label{for: "#book-title"}
        Title
      .col-xs-6
        %input.form-control#book-title{type: "text", required: true}

    .form-group
      %label.control-label{for: "#book-desc"}
        Description
      .col-xs-6
        %textarea.form-control#book-desc{required: true}

    .form-group
      %label.control-label{for: "#book-lang"}
        Language
      .col-xs-6
        %select.form-control#book-lang{required: true}
          %option{:value => -1, disabled: true, selected: true}
          - @languages.each do |lang_code, lang_name|
            %option{:value => lang_code}
              #{lang_name}

    .form-group   
      %label.control-label{for: "#code-langs"}
        Code Languages
      .col-xs-6{id: "code-langs"}
        - @code_languages.each do |code_lang, code_info|
          .code-lang-opt.col-sm-6
            %input{type: "checkbox", name: "code-lang", id: "code-lang-#{code_lang}", value: code_lang}
            %label{for: "code-lang-#{code_lang}"}
              #{code_info[:label]}
    
    .form-group   
      %label.control-label{for: "#glob-exer-options"}
        Global Exercise Options
      .col-xs-6{id: "glob-exer-options"}
        %input{type: "checkbox", name: "jsav-debug", id: "jsav-debug", value: 'JXOP-debug'}
        %label{for: "jsav-debug"}
          JSAV Debug (for developers)

    -# .form-group
    -#   %label.control-label{}
    -#     Global Slideshow Options
    -#   .col-xs-6
    -#     .form-group
    -#       %input{type: "checkbox", id: "glob-ss-required"}
    -#       %label{for: "glob-ss-required"}
    -#         Required
    -#     .form-group
    -#       %label{for: "glob-ss-points"}
    -#         Points:
    -#       %input{type: "number", min: 0, value: 0, id: "glob-ss-points"}

    .form-group
      %label.control-label{}
        Global Khan-Academy Exercise Options
      .col-xs-6
        .form-group
          %label.control-label{for: "glob-ka-required"}
            Required:
          .col-xs-8
            %input.align-checkbox{type: "checkbox", id: "glob-ka-required", checked: "checked"}
        .form-group
          %label.control-label{for: "glob-ka-points"}
            Points:
          .col-xs-8
            %input{type: "number", min: 0, value: 1, id: "glob-ka-points"}
        .form-group
          %label.control-label{for: "glob-ka-threshold"}
            Threshold:
          .col-xs-8
            %input{type: "number", min: 1, value: 5, step: 1, id: "glob-ka-threshold"}

    .form-group
      %label.control-label{}
        Global Proficiency Exercise Options
      .col-xs-6
        .form-group
          %label.control-label{for: "glob-pe-required"}
            Required:
          .col-xs-8
            %input.align-checkbox{type: "checkbox", id: "glob-pe-required", checked: "checked"}
        .form-group
          %label.control-label{for: "glob-pe-points"}
            Points:
          .col-xs-8
            %input{type: "number", min: 0, value: 1, id: "glob-pe-points"}
        .form-group
          %label.control-label{for: "glob-pe-threshold"}
            Threshold:
          .col-xs-8
            %input{type: "number", min: 0.0, max: 1.0, value: 1.0, step: 0.1, id: "glob-pe-threshold"}
        -# .form-group
        -#   %label.control-label{for: "glob-pe-feedback"}
        -#     Feedback Mode:
        -#   %select{id: "glob-pe-feedback"}
        -#     %option{value: 'atend'}
        -#       atend
        -#     %option{value: 'continuous'}
        -#       continuous
        -# .form-group
        -#   %label.control-label{for: "glob-pe-fix"}
        -#     Fix Mode:
        -#   %select{id: "glob-pe-fix", disabled: true}
        -#     %option{value: 'undo'}
        -#       undo
        -#     %option{value: 'fix'}
        -#       fix
    .form-group
      %label.control-label{}
        Global External Tool Options
      .col-xs-6
        .form-group
          %label.control-label{for: 'glob-extr-points'}
            Points:
          .col-xs-8
            %input{type: "number", min: 0, value: 1, id: "glob-extr-points"}
        
    - @learning_tools.each do |tool|
      .form-group
        %label.control-label{}
          Global #{tool.name} Options
        .col-xs-6
          .form-group
            %label.control-label{for: "glob-#{tool.name}-points"}
              Points:
            .col-xs-8
              %input{type: "number", min: 0, value: 1, id: "glob-#{tool.name}-points"}

    .form-group
      %label.control-label{for: "#other-options"}
        Other Options
      .col-xs-6{id: "other-options"}
        .col-sm-6
          %input{type: "checkbox", name: "build-jsav", id: "build-jsav"}
          %label{for: "build-jsav"}
            Build JSAV
        .col-sm-6
          %input{type: "checkbox", name: "supress-todo", id: "suppress-todo", checked: "checked"}
          %label{for: "suppress-todo"}
            Supress ToDo
        .col-sm-6
          %input{type: "checkbox", name: "disp-mod-comp", id: "disp-mod-comp", checked: "checked"}
          %label{for: "disp-mod-comp"}
            Display Module Completion
        
    %div{id: "book-content-container"}
      %h2 
        Book Content
      %ul
        %li
          First, select your language above.
        %li
          Books are organized into <i class="fa fa-folder-o"></i><i>chapters</i>, with each chapter containing
          one or more <i class="fa fa-files-o"></i><i>modules</i>. You choose how to organize your desired
          modules into chapters.
        %li
          A module may contain zero or more <i class="fa fa-file-o"></i><i>sections</i>, and
          a section may contain zero or more <i>exercises</i> and/or <i>slideshows</i>.
        %li
          To <b>add a chapter</b> to your book, click the "+ Chapter" button and
          enter a name for the chapter.
        %li
          To <b>remove a chapter</b> and all of its modules from your book, right click 
          on the <i class="fa fa-folder-o"></i>chapter and press "Delete".
        %li
          To <b>add a module</b> to your book, click and drag a <i class="fa fa-files-o"></i>module from 
          the Available pane and drop it in the Included pane in the 
          desired <i class="fa fa-folder-o"></i>chapter. You can select
          multiple modules by holding Ctrl (Mac: Command ⌘) and clicking on
          the desired modules. To select multiple sequentially listed modules,
          click on the first module, then hold Shift and click on the last
          module.
        %li
          To <b>remove a module</b> from your book, right click on the <i class="fa fa-files-o"></i>module 
          in the Included pane and press "Remove".
        %li
          <b>Reorder chapters and modules</b> in your book using drag-and-drop. 
          The order of the chapters and modules in the Included pane will be the 
          order of the chapters and modules in your book.

      .col-xs-12.icon-legend
        %div
          <b>Icon Legend</b>
        .col-lg-6.col-md-8.col-sm-10
          %span.col-sm-4.col-xs-12
            <i class="fa fa-folder-o"></i> Chapter
          %span.col-sm-8.col-xs-12
            <b>SS</b> Slideshow
          %span.col-sm-4.col-xs-12
            <i class="fa fa-files-o"></i> Module
          %span.col-sm-8.col-xs-12
            <b>KA</b> Khan-Academy Style Exercise
          %span.col-sm-4.col-xs-12
            <i class="fa fa-file-o"></i> Section
          %span.col-sm-8.col-xs-12
            <b>PE</b> Proficiency Exercise
          %span.col-sm-8.col-sm-offset-4.col-xs-12
            <b>ET</b> External Tool Exercise (CodeWorkout)
        .col-xs-12
          .col-xs-12
            <b style='color: orange'>M</b> This item has been modified with settings different from the defaults
          .col-xs-12
            <b style='color: orange'>•</b> This item has children who have been modified with settings different from the defaults

      %div{id: "split-container"}
        %div.split.split-horizontal{id: "chosen-pane"}
          %h3.split-pane-header
            Included Modules
          %input.btn.btn-success{id: "btn-add-chapter", type: "button", value: "+ Chapter", disabled: true}
          .split-pane-content
            .tree-container
              %div{id: "included-modules"}
        %div.split.split-horizontal{id: "available-pane"}
          %h3.split-pane-header
            Available Modules
          .split-pane-content
            .tree-container
              %div{id: "available-modules"}

    .form-group.col-xs-12{style: "margin-top: 15px;"}
      %button.btn.btn-primary.col-xs-offset-5{type: "submit"}
        Download Configuration  
          